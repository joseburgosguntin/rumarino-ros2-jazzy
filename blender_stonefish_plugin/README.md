# Blender to Stonefish Converter
This tool extracts objects from Blender `.blend` files and generates Stonefish `.scn` scenario files with proper coordinate transformations and material/look definitions.


## Installation
```bash
pip install pyyaml inotify
```
pyyaml is for extracting the yaml files into dictionaries and inotify is for the watchdog daemon that automatically updates the output.scn file.

## How to use it with Blender

Basically, in order to parse your objects into the `.scn` file, the name of your objects must start with the `SF_` prefix. For example `SF_Ground` or `SF_Wall`.

### Use the Custom properties in Blender

The way we decided to give the Stonefish properties from Blender is by using the Custom Properties of Blender Objects.
Custom properties are at the bottom of the object properties, looking like this:
![alt text](assets/image.png)

What you have to make sure of is that all Stonefish objects have a custom property called `geometry_type`.

Which has the following options:
1. mesh
2. box
3. plane
4. cylinder
5. torus



### 3. Convert Blender to Stonefish

**Single conversion:**
```bash
python3 main.py scene.blend -o output.scn -c config_new.yaml
```

**Watch mode (auto-regenerate on file changes):**
```bash
python3 daemon.py scene.blend config_new.yaml output.scn
```

The daemon watches both the `.blend` file and config file, automatically regenerating the scenario when either changes.


## Don't run the Plugin yet!!!!

If you're reading this, it means that you're kind of responsible for what you're running. This means take into consideration the following things before running this:

1. The plugin doesn't support all the features of Stonefish. At the moment it only supports environment tags and Static objects.
2. A part of this plugin was generated with Claude Sonnet 4.5. In general, there are some parts of the `blender_extractor.py` that extract certain parts of the Binary data that I couldn't figure out by myself, and also the `mesh_extractor.py` was almost entirely generated by AI. As well as the daemon that's using a library called inotify that comes from the kernel system call inotify API.

3. Don't use Developer versions of Blender. The latest version of Blender right now, Blender Version 5, uses a different header format and it's compressed. I'm using version LTS 4.5 and it works pretty good.


## Thank You!!

- **Stonefish Simulator**: [https://github.com/patrykcieslak/stonefish](https://github.com/patrykcieslak/stonefish)
- **blendfile.py**: Used for reading Blender files - [https://github.com/scorpion81/blender-addons/tree/master/io_blend_utils](https://github.com/scorpion81/blender-addons/tree/master/io_blend_utils)

